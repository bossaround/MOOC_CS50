---
title: "Survival Analysis"
output: html_notebook
---
```{r}
load(url("https://github.com/bossaround/MOOC_CS50/raw/master/CS50_MOOC_Survival_Analysis_Data_0.RData"))
load(url("https://github.com/bossaround/MOOC_CS50/raw/master/CS50_MOOC_Survival_Analysis_Data_1.RData"))
```
This is the model used to draw the hazard plot
```{r}
model.for.plot <- glm(drop ~ milestone + milestone2 + milestone3+ male +milestone*male +  age +  testtot  +foreign + gamehour5 + testtot*milestone  , family="binomial", data=dat7)
summary(model.for.plot)
```


```{r}
timevaryingmodel <- glm(drop ~ milestone + milestone2+ male + age +edu +  school +  testtot  +foreign + extrovert+ gamehour5 + csexperience + motiv +csexperience*ms + testtot*milestone + male*milestone2  + age*milestone+  testtot*milestone2 + click +click*milestone +click*milestone2, data=dat7)
summary(timevaryingmodel)
```

```{r}
model1c <- glm(drop ~ milestones + milestones2+milestones3+ male + age +edu +  school +  testtot  +foreign + extrovert+ gamehour5 + csexperience + motiv, data=dat7)

model2c <- glm(drop ~ milestones + milestones2+ milestones3+male + age  +  testtot  +foreign + extrovert+ gamehour5 + csexperience + motiv +csexperience*milestones+ csexperience*milestones2 + testtot*milestones +male*milestones+ male*milestones2  + age*milestones+ age*milestones2+ testtot*milestones2 , data=dat7)

model3c <- glm(drop ~ milestones + milestones2+milestones3+ male + age +  testtot  +foreign + extrovert+ gamehour5 + csexperience + motiv  + click , data=dat7)

model4c <- glm(drop ~ milestones + milestones2+milestones3+ male + age  +  testtot  +foreign + extrovert+ gamehour5 + csexperience + motiv +csexperience*milestones+ csexperience*milestones2 + testtot*milestones +male*milestones+ male*milestones2  + age*milestones+ age*milestones2+ testtot*milestones2 + click, data=dat7)

model5c <- glm(drop ~ milestones + milestones2+milestones3+ male + age  +  testtot  +foreign + extrovert+ gamehour5 + csexperience + motiv +csexperience*milestones+ csexperience*milestones2 + testtot*milestones +male*milestones+ male*milestones2  + age*milestones+ age*milestones2+ testtot*milestones2  + click +click*milestones +click*milestones2, data=dat7)
```
```{r results="asis",warning=FALSE,message=FALSE}
 stargazer :: stargazer(model1c,model2c, model3c, model4c ,model5c, type="html",
                        dep.var.labels = "Logit Hazard",
                       title = "Discrete survival analysis predicting logit hazard of dropout, including final and optional assignment")
```
```{r}
dat10 <- dat7[dat7$milestones<9,]
table(dat7$milestones)
table(dat7$milestones)
```
```{r}
model1l <- glm(drop ~ milestones + male + age +edu +  school +  testtot  +foreign + extrovert+ gamehour5 + csexperience + motiv, data=dat10)

model2l <- glm(drop ~ milestones + male + age  +  testtot  +foreign + extrovert+ gamehour5 + csexperience + motiv +csexperience*milestones+ csexperience*milestones2 + testtot*milestones +male*milestones+ male*milestones2  + age*milestones+ age*milestones2+ testtot*milestones2 , data=dat10)

model3l <- glm(drop ~ milestones + male + age +  testtot  +foreign + extrovert+ gamehour5 + csexperience + motiv  + click , data=dat10)

model4l <- glm(drop ~ milestones + male + age  +  testtot  +foreign + extrovert+ gamehour5 + csexperience + motiv +csexperience*milestones+ csexperience*milestones2 + testtot*milestones +male*milestones+ male*milestones2  + age*milestones+ age*milestones2+ testtot*milestones2 + click, data=dat10)

model5l <- glm(drop ~ milestones + male + age  +  testtot  +foreign + extrovert+ gamehour5 + csexperience + motiv +csexperience*milestones+ csexperience*milestones2 + testtot*milestones +male*milestones+ male*milestones2  + age*milestones+ age*milestones2+ testtot*milestones2  + click +click*milestones +click*milestones2, data=dat10)
```
```{r results="asis",warning=FALSE,message=FALSE}
 stargazer :: stargazer(model1l,model2l, model3l, model4l ,model5l, type="html",
                        dep.var.labels = "Logit Hazard",
                       title = "Discrete survival analysis predicting logit hazard of dropout, excluding final and optional assignment")
```
